{% extends "base.html" %}

{% block content %}
<div style="margin-bottom: 2rem;">
    <a href="/events/" class="btn btn-secondary">‚Üê Back to Events</a>
</div>

<h1>{{ event.name }}</h1>

<div style="margin-top: 2rem;">
    <h3>Event Details</h3>
    <table style="width: auto;">
        <tr>
            <th style="width: 200px;">ID</th>
            <td>{{ event.id }}</td>
        </tr>
        <tr>
            <th>Name</th>
            <td>{{ event.name }}</td>
        </tr>
        <tr>
            <th>Description</th>
            <td>{{ event.description or 'N/A' }}</td>
        </tr>
        <tr>
            <th>Template</th>
            <td>{{ event.template_path or 'No template uploaded' }}</td>
        </tr>
        <tr>
            <th>Created At</th>
            <td>{{ event.created_at.strftime('%Y-%m-%d %H:%M:%S') if event.created_at else 'N/A' }}</td>
        </tr>
        <tr>
            <th>Total Jobs</th>
            <td>{{ event.jobs|length }}</td>
        </tr>
    </table>
</div>

<div style="margin-top: 2rem; display: flex; gap: 1rem;">
    <a href="/events/{{ event.id }}/edit" class="btn">Edit Event</a>
    <a href="/jobs/create?event_id={{ event.id }}" class="btn">Create Job for This Event</a>
    
    <form method="POST" action="/events/{{ event.id }}/delete" style="display: inline;" 
          onsubmit="return confirm('Are you sure you want to delete this event? This will also delete all associated jobs.');">
        <button type="submit" class="btn btn-danger">Delete Event</button>
    </form>
</div>

{% if event.jobs %}
<div style="margin-top: 3rem;">
    <h3>Recent Jobs</h3>
    <table>
        <thead>
            <tr>
                <th>Job ID</th>
                <th>Status</th>
                <th>Progress</th>
                <th>Created</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for job in event.jobs[:10] %}
            <tr>
                <td>{{ job.id }}</td>
                <td>{{ job.status }}</td>
                <td>{{ job.generated_certificates }}/{{ job.total_certificates }}</td>
                <td>{{ job.created_at.strftime('%Y-%m-%d %H:%M') if job.created_at else 'N/A' }}</td>
                <td>
                    <a href="/jobs/{{ job.id }}" class="btn" style="padding: 5px 10px; font-size: 0.9rem;">View</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endif %}
{% endblock %}
